<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="morrowplots">
<title>Morrow Plots Data Visualizations • morrowplots</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Morrow Plots Data Visualizations">
<meta property="og:description" content="morrowplots">
<meta property="og:image" content="https://SandiCal.github.io/morrowplots/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">morrowplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to the Morrow Plots</a>
    <a class="dropdown-item" href="../articles/morrow-plots-data-visualizations.html">Morrow Plots Data Visualizations</a>
    <a class="dropdown-item" href="../articles/national-yield-comparison.html">National Yield Comparison</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Morrow Plots Data Visualizations</h1>
            
      
      
      <div class="d-none name"><code>morrow-plots-data-visualizations.Rmd</code></div>
    </div>

    
    
<p>This exercise uses dplyr and ggplot2 to show some examples of ways
you might summarize and visualize data from the Morrow Plots.</p>
<p>You should install the dplyr and ggplot2 packages if you haven’t done
so already.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sandical.github.io/morrowplots/" class="external-link">morrowplots</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The Morrow Plots experiment tests how crop rotation and soil
treatments affect corn yields. Plot 3 grows continuous corn. Plot 4
grows corn every other year. At first, Plot 4 corn was alternated with
oats, but starting in 1967 soybeans were planted instead. Plot 5 uses a
3-crop rotation of corn, oats, and hay. Each plot has some subplots that
receive fertilizing soil treatments and some subplots that are
untreated.</p>
<p>Before we start visualizing this data, let’s first take a look at the
data to see what we’re working with.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">morrowplots</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 26</span></span></span>
<span><span class="co">#&gt;   phase  year plot  plot_num plot_dir rotation corn  crop  variety      all_corn</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1  <span style="text-decoration: underline;">1</span>888 3NA          3 NW              1 TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1  <span style="text-decoration: underline;">1</span>888 3NB          3 NW              1 TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1  <span style="text-decoration: underline;">1</span>888 3NC          3 NE              1 TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1  <span style="text-decoration: underline;">1</span>888 3ND          3 NE              1 TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1  <span style="text-decoration: underline;">1</span>888 3SA          3 SW              1 TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     1  <span style="text-decoration: underline;">1</span>888 3SB          3 SW              1 TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 16 more variables: yield_bush &lt;dbl&gt;, yield_ton &lt;dbl&gt;, treated &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   treatment &lt;chr&gt;, manure &lt;dbl&gt;, lime &lt;dbl&gt;, nit &lt;dbl&gt;, p205 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   k20 &lt;dbl&gt;, stover &lt;dbl&gt;, population &lt;dbl&gt;, plant_date &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   plant_day &lt;dbl&gt;, soil_sample &lt;lgl&gt;, damage &lt;chr&gt;, notes &lt;chr&gt;</span></span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="corn-yield-trends">Corn Yield Trends<a class="anchor" aria-label="anchor" href="#corn-yield-trends"></a>
</h2>
<p>We’ll use the ‘yield_bush’ data to plot corn yields over time, and
the ‘rotation’ and ‘treated’ variables to compare the results of
different growing strategies.</p>
<p><br></p>
<p><strong>Subset corn data</strong></p>
<p>First we need to filter the data to only include corn data. The
‘corn’ field is the easiest way to do this. It’s TRUE/FALSE and it
includes both continuous corn (Plot 3) and corn in rotation with other
crops (Plots 4 and 5).</p>
<p>We have a few years where ‘yield_bush’ data is missing and marked
with ‘NA’. We’ll filter those out too so they don’t show up in our
visualizations. If you’d like to see NAs, by all means leave them
in.</p>
<p>In addition to filters, we also need to reformat the ‘rotation’ data
that marks whether corn is planted every 1, 2, or 3 years. Since this
data is numerical, R treats it as a double, but if we reformat it as a
factor we can use it to group data in our visualizations. We can do that
with the mutate function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## name the new dataset mp corn for morrow plots corn</span></span>
<span><span class="va">mpcorn</span> <span class="op">&lt;-</span> </span>
<span>  </span>
<span>  <span class="co">## filter to only include rows where corn is TRUE and 'yield_bush' is not 'NA'</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">morrowplots</span>, <span class="va">corn</span> <span class="op">==</span> <span class="cn">TRUE</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">yield_bush</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="co">## change 'rotation' data type from double to factor</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">rotation</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mpcorn</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 26</span></span></span>
<span><span class="co">#&gt;   phase  year plot  plot_num plot_dir rotation corn  crop  variety      all_corn</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1  <span style="text-decoration: underline;">1</span>888 3NA          3 NW       1        TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1  <span style="text-decoration: underline;">1</span>888 3NB          3 NW       1        TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1  <span style="text-decoration: underline;">1</span>888 3NC          3 NE       1        TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1  <span style="text-decoration: underline;">1</span>888 3ND          3 NE       1        TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1  <span style="text-decoration: underline;">1</span>888 3SA          3 SW       1        TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     1  <span style="text-decoration: underline;">1</span>888 3SB          3 SW       1        TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 16 more variables: yield_bush &lt;dbl&gt;, yield_ton &lt;dbl&gt;, treated &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   treatment &lt;chr&gt;, manure &lt;dbl&gt;, lime &lt;dbl&gt;, nit &lt;dbl&gt;, p205 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   k20 &lt;dbl&gt;, stover &lt;dbl&gt;, population &lt;dbl&gt;, plant_date &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   plant_day &lt;dbl&gt;, soil_sample &lt;lgl&gt;, damage &lt;chr&gt;, notes &lt;chr&gt;</span></span></span></code></pre></div>
<p><br></p>
<p><strong>Plot Corn Yield Trend Lines</strong></p>
<p>We’ll use geom_smooth to visualize trend lines for corn yields over
the course of the experiment. Corn yields vary quite a bit from year to
year because of uncontrolled variables like the weather. With a regular
line graph, the lines would have drastic highs and lows, but geom_smooth
averages the data to help us see the overall pattern.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## create a smooth line plot with 'year' on the x axis and 'yield_bush' on the y axis</span></span>
<span><span class="co">## color code the lines by 'rotation'</span></span>
<span><span class="co">## use line type to differentiate between treated and untreated corn</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpcorn</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">yield_bush</span>, color <span class="op">=</span> <span class="va">rotation</span>, linetype <span class="op">=</span> <span class="va">treated</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span></span>
<span>  <span class="co">## add title and subtitle</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Morrow Plots Corn Yield Trends in Bushels per Acre"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Treated vs. untreated and by number of crops in rotation"</span><span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## add one of the built-in themes</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="morrow-plots-data-visualizations_files/figure-html/mpcorn%20smooth-1.png" width="672"></p>
<p><br></p>
<p><strong>Interpreting the Results</strong></p>
<p>With geom_smooth, clear patterns emerge. Treated corn produces higher
yields than untreated corn. We can also see that continuous corn
provides the lowest yields. Corn in a 2-crop rotation performs better,
and corn in a 3-crop rotation performs best.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="corn-yield-data-in-more-detail">Corn Yield Data in More Detail<a class="anchor" aria-label="anchor" href="#corn-yield-data-in-more-detail"></a>
</h2>
<p>Our smooth line graph synthesizes over a century of data into clear
trends, but we can visualize the Morrow Plots in much greater detail
with geom_point. The facet_wrap function in ggplot2 is also really handy
for the Morrow Plots because it allows us to create grids of related
graphs that are organized in the same way as the actual farm plots.</p>
<p><br></p>
<p><strong>Yields by Plot</strong></p>
<p>The geom_smooth plot above uses ‘rotation’ to create groupings, but
we can get the same groupings with ‘plot_num’. Since we’re using
facet_wrap to mimic the layout of the farm plots, it makes more sense to
use ‘plot_num’ as a label.</p>
<p>Since geom_point plots every data point in ‘yield_bush’ we’ll see a
lot more data from Plot 3 where corn is grown every year compared with
Plots 4 and 5 that rotate corn with other crops.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## create a smooth line plot with 'year' on the x axis and 'yield_bush' on the y axis</span></span>
<span><span class="co">## color code the lines by 'treated'</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpcorn</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">yield_bush</span>, color <span class="op">=</span> <span class="va">treated</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## create a grid of related plots with facet_wrap</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">plot_num</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## add title and subtitle</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Morrow Plots Corn Yields in Bushels per Acre"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Treated vs. untreated by plot"</span><span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## add one of the built-in themes</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="morrow-plots-data-visualizations_files/figure-html/plot-1.png" width="672"></p>
<p><br></p>
<p><strong>Yields by Subplot</strong></p>
<p>Each of the 3 plots also have 8 subplots that receive different soil
treatments. If we filter our data to one plot, we can use facet_wrap to
break the data down by subplot and arrange it the same way the subplots
are organized on the field with 4 northern subplots and 4 southern
subplots.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## create a smooth line plot with 'year' on the x axis and 'yield_bush' on the y axis</span></span>
<span><span class="co">## color code the lines by 'treated'</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mpcorn</span>, <span class="va">plot_num</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">yield_bush</span>, color <span class="op">=</span> <span class="va">treated</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## create a grid of related plots with facet_wrap</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## add title and subtitle</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Morrow Plots Corn Yields in Bushels per Acre"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Plot 5 treated vs. untreated by subplot"</span><span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## add one of the built-in themes</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="morrow-plots-data-visualizations_files/figure-html/subplot%20treated-1.png" width="672"></p>
<p><br></p>
<p><strong>Yields by Subplot and Specific Treatment</strong></p>
<p>Finally, we can look at the same data in even greater detail if we
color code it by the specific treatment strategy.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## create a smooth line plot with 'year' on the x axis and 'yield_bush' on the y axis</span></span>
<span><span class="co">## color code the lines by 'treated'</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mpcorn</span>, <span class="va">plot_num</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">yield_bush</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## create a grid of related plots with facet_wrap</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## add title and subtitle</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Morrow Plots Corn Yields in Bushels per Acre"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Plot 5 by subplot and treatment"</span><span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## add one of the built-in themes</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="morrow-plots-data-visualizations_files/figure-html/subplot%20treatment-1.png" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sandi Caldrone, Heidi Imker, Josh Henry.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
